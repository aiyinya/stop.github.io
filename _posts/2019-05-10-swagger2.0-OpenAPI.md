---
layout: post
title:  "swagger2.0 swagger UI"
date:   2019-05-10 23:36:30 +0800
categories: swagger 
tags:  swagger
author: Xu ShiJie
mathjax: false
---




* content
{:toc}


### Swagerä½¿ç”¨æ‰‹å†Œ

[TOC]

##   å‰è¨€

     å¦‚ä½•ç¼–å†™åŸºäºOpenAPIè§„èŒƒçš„APIæ–‡æ¡£

## ç¼–å†™ç›®çš„

    æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨Swaggerç¼–å†™APIæ–‡æ¡£ã€‚é€šè¿‡é˜…è¯»æœ¬æ–‡ï¼Œä½ å¯ä»¥ï¼š


- äº†è§£swaggeræ˜¯ä»€ä¹ˆ
- æŒæ¡ä½¿ç”¨swaggerç¼–å†™APIæ–‡æ¡£çš„åŸºæœ¬æ–¹æ³•

## ç¬¬ä¸€ç«  ç®€ä»‹
    
    Swagger

 - Swaggeræ˜¯ä¸€ä¸ªç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„APIè¡¨è¾¾å·¥å…·ã€‚
 - ä½¿ç”¨Swaggerç”Ÿæˆçš„APIï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°äº¤äº’å¼æ–‡æ¡£
    
    
    
### OpenAPIè§„èŒƒ
    
    OpenAPIè§„èŒƒæ˜¯LinuxåŸºé‡‘ä¼šçš„ä¸€ä¸ªé¡¹ç›®ï¼Œè¯•å›¾é€šè¿‡å®šä¹‰ä¸€ç§ç”¨æ¥æè¿°APIæ ¼å¼æˆ–
    APIå®šä¹‰çš„è¯­è¨€ï¼Œæ¥è§„èŒƒRESTfulæœåŠ¡å¼€å‘è¿‡ç¨‹ã€‚OpenAPIè§„èŒƒå¸®åŠ©æˆ‘ä»¬æè¿°ä¸€ä¸ª
    APIçš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š

-   æœ‰å…³è¯¥APIçš„ä¸€èˆ¬æ€§æè¿°
-   å¯ç”¨è·¯å¾„ï¼ˆ/èµ„æºï¼‰
-   åœ¨æ¯ä¸ªè·¯å¾„ä¸Šçš„å¯ç”¨æ“ä½œï¼ˆè·å–/æäº¤...ï¼‰
-   æ¯ä¸ªæ“ä½œçš„è¾“å…¥/è¾“å‡ºæ ¼å¼

>ç›®å‰V2.0ç‰ˆæœ¬çš„[OpenAPI](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md)è§„èŒƒï¼ˆä¹Ÿå°±æ˜¯SwaggerV2.0è§„èŒƒï¼‰å·²ç»å‘å¸ƒå¹¶å¼€æºåœ¨
>githubä¸Šã€‚è¯¥æ–‡æ¡£å†™çš„éå¸¸å¥½ï¼Œç»“æ„æ¸…æ™°ï¼Œæ–¹ä¾¿éšæ—¶æŸ¥é˜…ã€‚å…³äºè§„èŒƒçš„å­¦ä¹ å’Œç†
>è§£ï¼Œæœ¬æ–‡æœ€åè¿˜æœ‰ä¸ªå½©è›‹

### ä¸ºå•¥è¦ä½¿ç”¨OpenAPIè§„èŒƒ

- OpenAPIè§„èŒƒè¿™ç±»APIå®šä¹‰è¯­è¨€èƒ½å¤Ÿå¸®åŠ©ä½ æ›´ç®€å•ã€å¿«é€Ÿçš„è¡¨è¿°APIï¼Œå°¤å…¶æ˜¯åœ¨APIçš„è®¾è®¡é˜¶æ®µä½œç”¨ç‰¹åˆ«çªå‡º

- ä¸€æ—¦ç¼–å†™å®Œæˆï¼ŒAPIæ–‡æ¡£å¯ä»¥ä½œä¸º
    - éœ€æ±‚å’Œç³»ç»Ÿç‰¹æ€§æè¿°çš„æ ¹æ®
	- å‰åå°æŸ¥è¯¢ã€è®¨è®ºã€è‡ªæµ‹çš„åŸºç¡€
	- éƒ¨åˆ†æˆ–è€…å…¨éƒ¨ä»£ç è‡ªåŠ¨ç”Ÿæˆçš„æ ¹æ®


## ç¬¬äºŒç«  swagger æœ¬åœ°ç¯å¢ƒæ­å»º åŸºäºnode

- ä¸‹è½½Swagger UIï¼ˆä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½ zip æ–‡ä»¶ï¼‰

	```terminal
		git clone https://github.com/swagger-api/swagger-ui.git
	```

- å®‰è£… express
- åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ä½œä¸ºä½ swaggerçš„æœ¬åœ°çš„æ–‡ä»¶å¤¹

	```terminal
		mkdir swagger-app
	```

- åˆå§‹åŒ–node, åˆ›å»ºpackage.json

	``` terminal
		cd swagger_app	
		npm init -y
	```

- å®‰è£…express

	```terminal
		npm i express --save
	```

- åˆ›å»º index.js

	```js
		var express = require('express');
		var app = express();
		app.get('/', function (req, res) {
		  res.send('Hello Swagger!');
		});
		// ç«¯å£å·éšæ„
		app.listen(3333, function () {
		  console.log('Swagger_app listening on port 3333!');
		});
	```
- åœ¨ node_app ä¸­åˆ›å»ºç©ºç›®å½• public

	```terminal
		mkdir public
		cd public
	```
- ä¿®æ”¹è·¯ç”±  åœ¨index.js ç¬¬ä¸‰è¡Œæ’å…¥ä¸‹é¢ä»£ç 

	```js
		app.use('/static', express.static('public'));
	```

- æŠŠä¸‹è½½å¥½çš„Swagger UI æ–‡ä»¶ä¸­çš„ dist ç›®å½•ä¸‹çš„æ–‡ä»¶å…¨éƒ¨å¤åˆ¶åˆ° public æ–‡ä»¶å¤¹ä¸­

![](https://ws2.sinaimg.cn/large/006tNc79gy1g2trg7t7khj30no0n0go1.jpg)

- å¼€å¯node
```terminal
	node index.js
```
- æµè§ˆå™¨è¾“å…¥ [http://localhost:3333/static/index.html](http://localhost:3333/static/index.html)

> è¿™æ ·å°±é…ç½®å¥½äº†å®˜æ–¹çš„ä¾‹å­  å¯ä»¥åˆæ­¥äº†è§£çœ‹ä¸€ä¸‹

![å®˜ç½‘ä¾‹å­](https://ws1.sinaimg.cn/large/006tNc79ly1g2wh8liedsj319a0u0qeg.jpg)







## ç¬¬ä¸‰ç«  å¦‚ä½•ç¼–å†™ APIæ–‡æ¡£

    å¥½äº†ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å·²ç»æ­å»ºå¥½äº†swagger2.0çš„ui
    æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹äº†è§£å¦‚ä½•ç¼–å†™apiæ–‡æ¡£

### 3.1 è¯­è¨€ï¼š JSON vs YAML
> æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨JSONæˆ–è€…YAMLçš„è¯­è¨€æ ¼å¼æ¥ç¼–å†™APIæ–‡æ¡£ã€‚ä½†æ˜¯å¾ˆå¤šäººéƒ½å»ºè®®ä½¿ç”¨YAMLæ¥å†™ï¼ŒåŸå› æ˜¯å®ƒæ›´ç®€å•

YAMLè¯­æ³•ç®€ä»‹ [ä¼ é€é—¨](http://www.ruanyifeng.com/blog/2016/07/yaml.html)

### 3.2 ç¼–è¾‘å™¨
å¯ä»¥ç”¨ [Swagger Editor](http://editor.swagger.io/) åœ¨çº¿ç¼–è¾‘å™¨

![](https://ws4.sinaimg.cn/large/006tNc79ly1g2whg1wx6vj31bv0u01cy.jpg)
> å·¦è¾¹ç¼–è¾‘APIæ–‡æ¡£ï¼Œå³è¾¹å®æ—¶é¢„è§ˆ å®æ—¶æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ï¼ˆå¾ˆèµï¼Œè¶…å–œæ¬¢ï¼‰

### 3.3 ä»ç®€å•çš„yamlçš„ä¾‹å­å¼€å§‹ä¸€æ­¥ä¸€æ­¥å¼€äº†è§£swagger2.0å¦‚ä½•ç”¨yamlç¼–å†™apiæ–‡æ¡£

```yaml
swagger: "2.0"

info:
  version: 1.0.0
  title: Simple API
  description: A simple API to learn how to write OpenAPI Specification
schemes:
  - https
host: simple.api
basePath: /openapi101

paths: {}

```

	ä¸Šé¢ğŸ‘†å†…å®¹åˆ†ä¸º4ä¸ªéƒ¨åˆ†
	
	
> OpenAPIè§„èŒƒçš„ç‰ˆæœ¬å·

	é¦–å…ˆæˆ‘ä»¬è¦é€šè¿‡ä¸€ä¸ªå«swagger çš„å±æ€§æ¥å£°æ˜OpenAPIè§„èŒƒçš„ç‰ˆæœ¬
	
```yaml
swagger:"2.0"
```

	æ‰€ä»¥æˆ‘ä»¬äº†è§£äº†OpenApiè§„èŒƒæ˜¯åŸºäºSwaggerçš„
	
> APIæè¿°ä¿¡æ¯

	ç‰ˆæœ¬ã€æ ‡é¢˜ã€å…·ä½“æè¿°ä¿¡æ¯
	
```yaml
info:
  version: 1.0.0
  title: Simple API
  description: A simple API to learn how to write OpenAPI Specification
```

> APIçš„URL

	åè®®ã€ä¸»æœºåã€æ ¹è·¯å¾„
	æ‹¼æ¥ä¸€èµ·å°±æ˜¯ https://api.d.qiyukid.com/user,å¦‚æœæœ‰æ ¹è·¯å¾„å¯ä»¥åŠ ä¸Šæ ¹è·¯å¾„

```yaml
schemes:
  - https
host: api.d.qiyukid.com
# basePath: /user
```

> APIçš„æ“ä½œï¼ˆoperationï¼‰

	è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰å†™APIçš„æ“ä½œï¼Œç”¨ä¸€ä¸ªYAMLçš„ç©ºå¯¹è±¡ {} å äº†ä¸€ä¸ªä½ç½®ã€‚
	
	
### 3.4 å®šä¹‰ä¸€ä¸ªAPIæ“ä½œ

```yaml
#	æ·»åŠ è·¯å¾„ï¼Œè®¿é—®/persons
paths: 
  /persons:
  # æ·»åŠ HTTPçš„getè¯·æ±‚	è¿˜æœ‰å…¶ä»–çš„å¦‚ï¼š post\put\delete
    get:
    #	ä¿¡æ¯æ€»ç»“
      summary: Gets some persons
      #	è¯¦ç»†è¯´æ˜
      description: Returns a list containing all persons.
     #		å®šä¹‰å“åº”ï¼ˆresponseï¼‰ç±»å‹
     #		å¯¹äºæ¯ä¸ªæ–¹æ³•ï¼ˆæ“ä½œï¼‰ï¼Œéƒ½å¯ä»¥åœ¨å“åº”ä¸­æ·»åŠ ä»»æ„çš„httpçŠ¶æ€ç ï¼ˆæ¯”å¦‚200 ok æˆ–è€… 404 not found....ç­‰ç­‰ï¼‰ä¸‹é¢å°±æ˜¯æ·»åŠ äº†ç®€å•çš„ 200 æè¿°ä¿¡æ¯ä¸ºï¼š A list of Person
      responses:
        200:
          description: A list of Person
          #	å®šä¹‰å“åº”çš„å†…å®¹
          #	get/personsè¿™ä¸ªæ¥å£è¿”å›ä¸€ç»„ç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡å“åº”æ¶ˆæ¯ä¸­çš„ æ¨¡å¼ï¼ˆschemaï¼‰å±æ€§æ¥æè¿°å…·ä½“è¿”å›çš„å†…å®¹
          #	ä¸€ç»„ç”¨æˆ·ä¿¡æ¯å°±æ˜¯ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯å¯¹è±¡çš„æ•°ç»„ï¼ˆarrarï¼‰ï¼Œ
          #	æ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ åˆ™æ˜¯ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯å¯¹è±¡ï¼ˆobjectï¼‰ï¼Œ
          #	è¯¥å¯¹è±¡åŒ…å«ä¸‰ä¸ªstringç±»å‹çš„å±æ€§ï¼šfirstNameã€lastNameã€username
          schema:
            type: array
            items:
              required:
                - username
            properties:
              firstName:
                type: string
              lastName:
                type: string
              username:
                type: string
```

### 3.5 å®šä¹‰ è¯·æ±‚å‚æ•°		ï¼ˆquery parametersï¼‰
>  ç”¨æˆ·å¤ªå¤šï¼Œæˆ‘ä»¬ä¸æƒ³ä¸€è‚¡è„‘å…¨éƒ¨è¾“å‡ºå‡ºæ¥ã€‚è¿™ä¸ªæ—¶å€™ï¼Œåˆ†é¡µè¾“å‡ºæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œ
æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ è¯·æ±‚å‚æ•°æ¥å®ç°

```yaml
paths:
  /persons:
    get:
      summary: Gets some persons
        description: Returns a list containing all persons. The list supports paging.
#START----------------------------------------------------------------
      #	æ–°å¢çš„ã€å‚æ•°ã€‘å±æ€§
      parameters:
      #	æ·»åŠ åˆ†é¡µå‚æ•°
      #	æ·»åŠ äº†ä¸¤ä¸ªåå­— ï¼ˆnameï¼‰åˆ†åˆ«å«pageSizeã€pageNumber
      #	å¹¶åšäº†ç®€å•çš„æè¿°ä»¥åŠå®šä¹‰äº†ç±»å‹ä¸ºï¼ˆintegerï¼‰
        - name: pageSize
          in: query
          description: Number of personsreturned
          type: integer
          - name: pageNumber
          in: query
          description: Page number
          type: integer
#END----------------------------------------------------------------
          responses:
          200:
            description: A list of Person
            schema:
              type: array
              items:
                required:
                  - username
                properties:
                  firstName:
                    type: string
                  lastName:
                    type: string
                  username:
                    type: string
```

	è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ get/persons?pageSize=20&pageNumber=2æ¥è®¿é—®ç¬¬äºŒé¡µçš„ç”¨æˆ·ä¿¡æ¯äº†ï¼ˆ20æ¡ï¼‰
	
### 3.6	å®šä¹‰ è·¯å¾„å‚æ•° ï¼ˆpath parameterï¼‰

> æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦æ ¹æ®ç”¨æˆ·åæ¥æŸ¥æ‰¾ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªæ¥å£æ“ä½œï¼Œæ¯”å¦‚å¯ä»¥æ·»åŠ ä¸€ä¸ªç±»ä¼¼ /persons/{username} çš„æ“ä½œæ¥è·å–ç”¨æˆ·ä¿¡æ¯ã€‚
æ³¨æ„ï¼Œ{username} æ˜¯åœ¨è¯·æ±‚è·¯å¾„ä¸­çš„å‚æ•°ã€‚
	
```yaml
#	ä¸/persons: åŒçº§ç»§ç»­æ·»åŠ ä¸€ä¸ª persons/{username}:è·¯å¾„ ï¼ˆæ“ä½œï¼‰
#	å¹¶å®šä¹‰äº†ä¸€ä¸ªgetæ–¹æ³•
#	å®šä¹‰è·¯å¾„å‚æ•° {username}
#	å› ä¸º {username} æ˜¯è·¯å¾„å‚æ•°ï¼Œ
#	æˆ‘ä»¬éœ€è¦å…ˆåƒè¯·æ±‚å‚æ•°ä¸€æ ·å°†å®ƒæ·»åŠ åˆ°parameterså±æ€§ä¸­ï¼Œ
#	æ³¨æ„åç§°åº”è¯¥åŒä¸Šé¢å¤§æ‹¬å·ï¼ˆ { } ï¼‰ é‡Œé¢çš„åç§°ä¸€è‡´ã€‚
#	å¹¶é€šè¿‡ in è¿™ä¸ªå±æ€§ï¼Œæ¥è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªè·¯å¾„ï¼ˆpathï¼‰å‚æ•°ã€‚
persons/{username}:
  get:
    summary: Gets a person
    description: Returns a single person for its username
    parameters:
      - name: username
        in: path
        # å®šä¹‰è·¯å¾„å‚æ•°æ—¶å¾ˆå®¹æ˜“å‡ºç°çš„é—®é¢˜å°±æ˜¯å¿˜è®°ï¼š required: true ï¼Œ
        #	Swaggerçš„è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ä¸­æ²¡æœ‰åŒ…å«è¿™ä¸ªå±æ€§å®šä¹‰ã€‚ 
        #å¦‚æœæ²¡æœ‰å†™ require å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯falseã€‚
        #ä¹Ÿå°±æ˜¯è¯´ username å‚æ•°æ—¶å¯é€‰çš„ã€‚
        #å¯äº‹â¤µï¸å®ä¸Šï¼Œä½œä¸ºè·¯å¾„å‚æ•°ï¼Œå®ƒæ˜¯å¿…éœ€çš„ã€‚
        required: true
        description: The person's username
        type: string
    #	å®šä¹‰å“åº”æ¶ˆæ¯
    #	åˆ«å¿˜äº†è·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯ä¹Ÿéœ€è¦å¡«å†™ 200 å“åº”æ¶ˆæ¯
    #	å“åº”æ¶ˆæ¯ä½“çš„å†…å®¹å°±æ˜¯ä¹‹å‰æè¿°è¿‡çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆç”¨æˆ·ä¿¡æ¯åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼‰
    responses:
      200:
        description: A Person
        schema:
          required:
            - username
            properties:
            firstName:
              type: string
            lastName:
              type: string
            username:
              type: string
      #	APIçš„æä¾›è€…ä¼šå¯¹ username è¿›è¡Œæ ¡éªŒã€‚
      #	å¦‚æœæŸ¥æ— æ­¤äººï¼Œåº”è¯¥è¿”å› 404 çš„å¼‚å¸¸çŠ¶æ€ã€‚
      #	æ‰€ä»¥æˆ‘ä»¬å†åŠ ä¸Š 404 çŠ¶æ€çš„å“åº”
      404:
        description: The Person does not exists.
```


### 3.7	å®šä¹‰ æ¶ˆæ¯ä½“å‚æ•° ï¼ˆbody parameterï¼‰

> å½“æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½å¤Ÿæä¾› post /persons çš„APIæ“
ä½œ

```yaml
#	åœ¨/persons è·¯å¾„ä¸‹æ·»åŠ äº†ä¸€ä¸ªpostæ“ä½œ
post:
  summary: Creates a person
  description: Adds a new person to the persons list.
  parameters:
    - name: person
      #	é€šè¿‡inå±æ€§æ˜¾ç¤ºè¯´æ˜å‚æ•°æ˜¯åœ¨bodyä¸­çš„ã€‚
      #	å‚æ•°çš„å®šä¹‰å‚è€ƒ get/persons{username}çš„200å“åº”æ¶ˆæ¯ä½“å‚æ•°
      #	ä¹Ÿå°±æ˜¯åŒ…å«ç”¨æˆ·çš„lastNameã€firstNameã€userName
    in: body
    description: The person to create.
    schema:
      required:
        - username
      properties:
        firstName:
          type: string
        lastName:
          type: string
        username:
          type: string
  #	æœ€åä¹Ÿä¸è¦å¿˜è®°äº†postæ“ä½œçš„å“åº”æ¶ˆæ¯
  responses:
    204:
      description: Persons succesfully created.
    400:
      description: Persons couldn't have been created.
```

	å¥½äº†ï¼Œè¿™ä¸€ç« çš„å†…å®¹å€Ÿå®¿äº†ï¼Œæ€»ç»“ä¸€ä¸‹è¿™ä¸€ç« çš„å†…å®¹ï¼Œ
	åŸºæœ¬ä¸Šæˆ‘ä»¬ä»é›¶å¼€å§‹ç”¨yamlè¯­æ³•å»ºç«‹äº†ä¸€ä¸ªåŸºç¡€çš„APIæ–‡æ¡£ï¼Œ
	è¿™ä¸ªæ–‡æ¡£å†…å®¹åŒ…æ‹¬ï¼š
	1ã€OpenAPIçš„ç‰ˆæœ¬å·
	2ã€APIæ–‡æ¡£çš„ä¿¡æ¯
		2.1 ç‰ˆæœ¬ã€æ ‡é¢˜ã€å…·ä½“æè¿°ä¿¡æ¯
		2.2 åè®®ã€ä¸»æœºåã€æ ¹è·¯å¾„
	3ã€å®šä¹‰ä¸€ä¸ªAPIæ“ä½œ
	4ã€å®šä¹‰ è¯·æ±‚å‚æ•° ï¼ˆQuery Parametersï¼‰
	5ã€å®šä¹‰ è·¯å¾„å‚æ•° ï¼ˆPath Parameterï¼‰
	6ã€å®šä¹‰ æ¶ˆæ¯ä½“å‚æ•° ï¼ˆBody Parameterï¼‰
	
	
## ç¬¬å››ç« 	ç˜¦èº«APIæ–‡æ¡£

>	ä¸Šé¢åŸºæœ¬ä¸Šå·²ç»å†™å‡ºäº†APIçš„ä¸€ä¸ªå®Œæ•´æ¡ˆä¾‹ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦ä¼˜åŒ–ä¸€ä¸‹ï¼Œå› ä¸ºä¸Šé¢çš„æ¡ˆä¾‹ä¸­å­˜åœ¨ä¸€äº›é‡å¤çš„å†…å®¹ï¼Œæˆ‘ä»¬è¿™ä¸€ç« å°†æŠŠä¸€äº›é‡å¤çš„å†…å®¹æŠ½ç¦»å‡ºæ¥ï¼Œæ”¾åˆ°æˆ‘ä»¬å­¦ä¹ çš„æ–°å±æ€§ï¼šï¼ˆdefinitionsï¼‰ä¸­ï¼Œæ¥ç®€åŒ–APIæ–‡æ¡£

### 4.1	ç®€åŒ–æ•°æ®æ¨¡å‹

>	æˆ‘ä»¬è§‚å¯Ÿåå¾—å‡º Personçš„å®šä¹‰å‡ºç°äº†å‡ æ¬¡

	åœ¨è¯·æ±‚å‚æ•°ã€è·¯å¾„å‚æ•°ã€bodyå‚æ•°ä¸­éƒ½æœ‰å®šä¹‰
	ä¸‹é¢çš„æ•°æ®æ¨¡å‹ï¼Œè¿™ä¹Ÿæ˜¯é‡è¦å¾ˆå…³é”®çš„éƒ¨åˆ†

```yaml
required:
  - username
properties:
  firstName:
    type: string
  lastName:
    type: string
  username:
    type: string
```

>	å¯ä»¥é€šè¿‡definitionå±æ€§é‡æ–°æ„å»ºä¸€ä¸‹


```yaml
#	æ–°å¢(å®šä¹‰)å±æ€§	ã€æ–‡æ¡£çš„æœ€æœ«å°¾ã€‘æ­¤å±æ€§å®šä¹‰çš„Personå¯ä»¥é€šè¿‡
#	$ref: "#/definitions/Person" å¼•ç”¨
#	åœ¨å®šä¹‰é¡¹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³å¼•ç”¨åˆšæ‰å®šä¹‰å¥½çš„ Person æ¥å¢åŠ å¦ä¸€ä¸ª å®šä¹‰ ï¼ŒPersonsã€‚
#	Persons æ˜¯ä¸€ä¸ª Person å¯¹è±¡çš„æ•°ç»„ã€‚
#	ä¸ä¹‹å‰ç›´æ¥å®šä¹‰çš„ä¸åŒä¹‹å¤„æ˜¯ï¼Œ
#	æˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ª å¼•ç”¨ ï¼ˆreferenceï¼‰å±æ€§ï¼Œ 
#	ä¹Ÿå°±æ˜¯ $ref æ¥å¼•ç”¨ Person ã€‚
definitions:
#	å¢åŠ ä¸€ä¸ª Person å¯¹è±¡çš„å®šä¹‰ï¼š
  Person:
    required:
      - username
    properties:
      firstName:
        type: string
      lastName:
        type: string
      username:
        type: string
  #	æ–°å¢çš„Personsçš„å®šä¹‰ï¼Œ
  Persons:
    type: array
    items:
    #		ğŸ‘‡å¼•ç”¨äº†ä¸€ä¸ªPersonå®šä¹‰å¢åŠ äº†å¦ä¸€ä¸ª Persons å®šä¹‰
    $ref: "#/definitions/Person"
```


> ä¸€æ—¦å®šä¹‰å¥½äº† Person ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸæ¥åœ¨å“åº”æ¶ˆæ¯ä¸­ç›¸åº”çš„å®šä¹‰å­—æ®µæ›¿æ¢æ‰ã€‚


	get/persons
	
ä¿®æ”¹å‰ï¼š

```yaml
responses:
  200:
    description: A list of Person
    schema:
      type: array
      items:
      required:
        - username
      properties:
        firstName:
          type: string
        lastName:
          type: string

```

ä¿®æ”¹åï¼š

```yaml
responses:
  200:
    description: A list of Person
    schema:
      $ref: "#/definitions/Persons"

```

> å…¶ä»–é‡å¤çš„ä»¥æ­¤ç±»æ¨
> 	post /persons	ä¹Ÿæ˜¯å¦‚æ­¤
>

### 4.2 ç®€åŒ–å“åº”æ¶ˆæ¯

	æˆ‘ä»¬çœ‹åˆ°äº† å¼•ç”¨ ï¼ˆ$refï¼‰çš„ä½œç”¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†æŠŠå®ƒç”¨åˆ°å“åº”æ¶ˆæ¯çš„å®šä¹‰ä¸­

åŸæ¥ï¼š
```yaml
responses:
  200:
    description: A Person
      schema:
        required:
          - username
        properties:
          firstName:
            type: string
          lastName:
            type: string
          username:
            type: string
```


ç°åœ¨ï¼š

```yaml
responses:
  200:
    description: A list of Person
    schema:
      $ref: "#/definitions/Persons"
```

>	å…¶ä»–çš„ä»¥æ­¤ç±»æ¨
500:
$ref: "#/responses/Standard500ErrorResponse"
### 4.3	å®šä¹‰å¯é‡ç”¨çš„HTTP 500 å“åº”

> å‘ç”ŸHTTP 500 é”™è¯¯æ—¶ï¼Œ åŠ å…¥æˆ‘ä»¬å¸Œæœ›æ¯ä¸€ä¸ªAPIæ“ä½œéƒ½è¿”å›ä¸€ä¸ªå¸¦æœ‰é”™è¯¯ç ï¼ˆerror codeï¼‰ å’Œ æè¿°ä¿¡æ¯ï¼ˆdataæˆ–messageï¼‰çš„å“åº”ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ 

```yaml
500:
  description: An unexpected error occured.
  schema:
    properties:
      code:
        type: string
      message:
        type: string
```


>	å¢åŠ ä¸€ä¸ªErrorå®šä¹‰

	åœ¨definitions:ä¸‹çš„ Person åŒçº§å®šä¹‰ Error
```yaml
Error:
  properties:
    code:
      type: string
    message:
      type: string
```

> 	ä¿®æ”¹æ‰€æœ‰çš„HTTP 500 çŠ¶æ€ç çš„è¿”å›çŠ¶æ€ä¸º


```yaml
500:
  description: An unexpected error occured.
  schema:
#START##########################################################
##################
    $ref: "#/definitions/Error"
#END##########################################################
##################
```

### 4.4 å®šä¹‰ä¸€ä¸ªå¯é‡ç”¨çš„å“åº”æ¶ˆæ¯

> ä¸Šé¢çš„æ–‡æ¡£ä¸­ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›é‡å¤çš„å†…å®¹ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®OpenAPIè§„èŒƒä¸­çš„
[responses](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#swaggerObject)ç« èŠ‚çš„æè¿°ï¼Œé€šè¿‡å®šä¹‰ä¸€ä¸ªå¯é‡ç”¨çš„å“åº”æ¶ˆæ¯ï¼Œæ¥è¿›ä¸€æ­¥ç®€åŒ–æ–‡æ¡£ã€‚

	

```yaml
# æ³¨æ„è¿™é‡Œæ˜¯åœ¨ definitions åŒçº§ä¸‹ æ–°å¢äº†
# responses ä¸”åœ¨ responses ä¸­å®šä¹‰äº†
# Standard500ErrorResponse
# ä¸”ä½¿ç”¨äº†Errorçš„å®šä¹‰
responses:
  Standard500ErrorResponse:
    description: An unexpected error occured.
    schema:
      $ref: "#/definitions/Error"
```

> æ³¨æ„ï¼šå“åº”ğŸ‘†æ¶ˆæ¯ä¸­å¼•ç”¨äº† Error çš„å®šä¹‰


### 4.5 ä½¿ç”¨å®šä¹‰çš„å“åº”æ¶ˆæ¯

> æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ å¼•ç”¨ ï¼ˆ$refï¼‰æ¥ä½¿ç”¨ä¸€ä¸ªå·²ç»å®šä¹‰å¥½çš„å“åº”æ¶ˆæ¯ï¼Œæ¯”å¦‚ï¼š

```yaml
responses:
  200:
    description: A list of Person
    schema:
      $ref: "#/definitions/Persons"
#START##########################################################
##################
  500:
    $ref: "#/responses/Standard500ErrorResponse"
# END ##########################################################
##################
```


### ç®€åŒ–å‚æ•°å®šä¹‰ é€šè¿‡refå¼•å…¥

> ç±»ä¼¼æ•°æ®æ¨¡å‹ã€å“åº”æ¶ˆæ¯çš„ç®€åŒ–ï¼Œå‚æ•°å®šä¹‰çš„ç®€åŒ–ä¹Ÿå¾ˆå®¹æ˜“

```yaml
#START##########################################################
##################

#	
parameters:
  username:
    name: username
    in: path
    required: true
    description: The person's username
    type: string
  pageSize:
    name: pageSize
    in: query
    description: Number of persons returned
    type: integer
  pageNumber:
    name: pageNumber
    in: query
    description: Page number
    type: integer
# END ##########################################################
##################
```

> åœ¨æœ‰ parameters å±æ€§çš„åœ°æ–¹å¼•ç”¨

```yaml
parameters:
  - $ref: "#/parameters/pageSize"
  - $ref: "#/parameters/pageNumber"
```


> è‡ªæ­¤æˆ‘ä»¬çš„APIåŸºæœ¬å·²ç»å­¦ä¹ å®Œæ¯•


æ›´å¤šé«˜çº§çš„swagger2.0 çš„OpenAPIè§„èŒƒå¯ä»¥å»[OpenAPI](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md) éšæ—¶æŸ¥é˜…



##  ç¬¬äº”ç«   ä»¥é½è¯­ä¸ºä¾‹ï¼Œç¼–å†™ç¬¬ä¸€ä¸ªAPIæ¥å£

```yaml
swagger: '2.0'
info: {version: 1.0.0, title: é½è¯­APIæ–‡æ¡£, description: é½è¯­é¡¹ç›®æµ‹è¯•æœåŠ¡å™¨æ–‡æ¡£API}
schemes: [https]
host: api.d.qiyukid.com
paths:
  /user/-wechat/:
    get:
      summary: å¾®ä¿¡ç™»é™†
      description: å¾®ä¿¡ç™»é™†
      parameters:
      - {name: fn, in: query, required: true, description: å¾®ä¿¡çš„å›è°ƒå‡½æ•°åç§°, type: string,
        default: fetch_user_token}
      - {name: code, in: query, required: true, description: ç”¨æˆ·id, type: string, default: 1}
      - {name: ., in: query, required: true, description: ç™»é™†çš„tToken, type: string,
        default: 81b56308424a2750f91bae6553b138eb}
      responses:
        '200':
          description: ç™»é™†æˆåŠŸ ok
          schema: {description: error 0}
        '404': {description: 404 not found!}
definitions:
  Person:
    required: [username]
    properties:
      firstName: {type: string}
      lastName: {type: string}
      username: {type: string}
  Persons:
    type: array
    items: {$ref: '#/definitions/Person'}

```


> copy ä»¥ä¸Šyaml ä»£ç  åˆ° [swagger.editor](https://editor.swagger.io)

>	å¯ä»¥åœ¨çº¿è°ƒè¯•,


> ä¹Ÿå¯ä»¥ç”¨`swagger editor` åœ¨çº¿ç¼–è¾‘å¥½`yaml` çš„`api`æ–‡æ¡£ã€‚ç„¶åä»¥`json`æ–‡ä»¶å€’å…¥åˆ°æœ¬åœ°

![](https://ws2.sinaimg.cn/large/006tNc79gy1g2tsucrl17j30ou0p6adn.jpg)

- å°†å¯¼å‡ºæœ¬åœ°çš„jsonæ–‡ä»¶æ”¾åˆ° swagger_app çš„ public ç›®å½•ä¸‹
- ä¿®æ”¹swaggerçš„ url ä¸º `/static/qiyu.json`
- é‡å¯ node æœåŠ¡ ï¼Œ æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:3333/static/index.html` å°±æ˜¯åˆšåˆšå†™å…¥çš„APIæ–‡æ¡£äº†


![](https://ws1.sinaimg.cn/large/006tNc79ly1g2wms0sslzj31b70u016v.jpg)



## ç¬¬å…­ç« 	æ€»ç»“

	yamlã€swaggerUIã€swagger editorã€OpenAPI
	
	éœ€è¦æœ‰åŸºæœ¬çš„è®¤è¯†ã€‚



